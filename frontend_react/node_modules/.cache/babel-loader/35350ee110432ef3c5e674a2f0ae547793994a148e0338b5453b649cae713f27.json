{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\varsa\\\\Quiz-Website-Project\\\\frontend_react\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport api from '../services/api';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const navigate = useNavigate();\n  const [user, setUser] = useState(() => {\n    const storedUser = localStorage.getItem('quizUser');\n    return storedUser ? JSON.parse(storedUser) : null;\n  });\n  const [accessToken, setAccessToken] = useState(() => localStorage.getItem('quizAccessToken'));\n  const [refreshToken, setRefreshToken] = useState(() => localStorage.getItem('quizRefreshToken'));\n\n  // Helper: Save tokens and user to localStorage\n  const saveAuth = (userData, access, refresh) => {\n    localStorage.setItem('quizUser', JSON.stringify(userData));\n    localStorage.setItem('quizAccessToken', access);\n    localStorage.setItem('quizRefreshToken', refresh);\n    setUser(userData);\n    setAccessToken(access);\n    setRefreshToken(refresh);\n  };\n\n  // Login function\n  const login = async ({\n    username,\n    password\n  }) => {\n    const res = await api.post('/users/login/', {\n      username,\n      password\n    });\n    const {\n      access,\n      refresh\n    } = res.data;\n\n    // Decode username from access token or request user profile separately\n    const userRes = await api.get('/users/profile/', {\n      headers: {\n        Authorization: `Bearer ${access}`\n      }\n    });\n    saveAuth(userRes.data, access, refresh);\n  };\n\n  // Signup function\n  const signup = async ({\n    username,\n    email,\n    password\n  }) => {\n    await api.post('/users/register/', {\n      username,\n      email,\n      password\n    });\n  };\n\n  // Logout function\n  const logout = () => {\n    localStorage.removeItem('quizUser');\n    localStorage.removeItem('quizAccessToken');\n    localStorage.removeItem('quizRefreshToken');\n    setUser(null);\n    setAccessToken(null);\n    setRefreshToken(null);\n  };\n\n  // Token refresh logic (periodic refresh)\n  useEffect(() => {\n    if (!refreshToken) return;\n    const refreshAccessToken = async () => {\n      try {\n        const res = await api.post('/token/refresh/', {\n          refresh: refreshToken\n        });\n        const {\n          access\n        } = res.data;\n        localStorage.setItem('quizAccessToken', access);\n        setAccessToken(access);\n      } catch {\n        logout();\n        navigate('/login');\n      }\n    };\n    const interval = setInterval(refreshAccessToken, 14 * 60 * 1000); // refresh every 14 minutes approx\n    return () => clearInterval(interval);\n  }, [refreshToken, navigate]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      accessToken,\n      refreshToken,\n      login,\n      signup,\n      logout,\n      setUser,\n      setAccessToken,\n      setRefreshToken\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"rEuptCzLdjEpmAzAzT7T7I/54Bs=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","api","useNavigate","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","navigate","user","setUser","storedUser","localStorage","getItem","JSON","parse","accessToken","setAccessToken","refreshToken","setRefreshToken","saveAuth","userData","access","refresh","setItem","stringify","login","username","password","res","post","data","userRes","get","headers","Authorization","signup","email","logout","removeItem","refreshAccessToken","interval","setInterval","clearInterval","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","$RefreshReg$"],"sources":["C:/Users/varsa/Quiz-Website-Project/frontend_react/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport api from '../services/api';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const navigate = useNavigate();\r\n  const [user, setUser] = useState(() => {\r\n    const storedUser = localStorage.getItem('quizUser');\r\n    return storedUser ? JSON.parse(storedUser) : null;\r\n  });\r\n  const [accessToken, setAccessToken] = useState(() => localStorage.getItem('quizAccessToken'));\r\n  const [refreshToken, setRefreshToken] = useState(() => localStorage.getItem('quizRefreshToken'));\r\n\r\n  // Helper: Save tokens and user to localStorage\r\n  const saveAuth = (userData, access, refresh) => {\r\n    localStorage.setItem('quizUser', JSON.stringify(userData));\r\n    localStorage.setItem('quizAccessToken', access);\r\n    localStorage.setItem('quizRefreshToken', refresh);\r\n    setUser(userData);\r\n    setAccessToken(access);\r\n    setRefreshToken(refresh);\r\n  };\r\n\r\n  // Login function\r\n  const login = async ({ username, password }) => {\r\n    const res = await api.post('/users/login/', { username, password });\r\n    const { access, refresh } = res.data;\r\n\r\n    // Decode username from access token or request user profile separately\r\n    const userRes = await api.get('/users/profile/', {\r\n      headers: { Authorization: `Bearer ${access}` },\r\n    });\r\n\r\n    saveAuth(userRes.data, access, refresh);\r\n  };\r\n\r\n  // Signup function\r\n  const signup = async ({ username, email, password }) => {\r\n    await api.post('/users/register/', { username, email, password });\r\n  };\r\n\r\n  // Logout function\r\n  const logout = () => {\r\n    localStorage.removeItem('quizUser');\r\n    localStorage.removeItem('quizAccessToken');\r\n    localStorage.removeItem('quizRefreshToken');\r\n    setUser(null);\r\n    setAccessToken(null);\r\n    setRefreshToken(null);\r\n  };\r\n\r\n  // Token refresh logic (periodic refresh)\r\n  useEffect(() => {\r\n    if (!refreshToken) return;\r\n\r\n    const refreshAccessToken = async () => {\r\n      try {\r\n        const res = await api.post('/token/refresh/', { refresh: refreshToken });\r\n        const { access } = res.data;\r\n        localStorage.setItem('quizAccessToken', access);\r\n        setAccessToken(access);\r\n      } catch {\r\n        logout();\r\n        navigate('/login');\r\n      }\r\n    };\r\n\r\n    const interval = setInterval(refreshAccessToken, 14 * 60 * 1000); // refresh every 14 minutes approx\r\n    return () => clearInterval(interval);\r\n  }, [refreshToken, navigate]);\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        accessToken,\r\n        refreshToken,\r\n        login,\r\n        signup,\r\n        logout,\r\n        setUser,\r\n        setAccessToken,\r\n        setRefreshToken,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}