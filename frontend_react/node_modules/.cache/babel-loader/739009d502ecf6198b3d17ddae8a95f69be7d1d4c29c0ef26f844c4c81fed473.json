{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport api from '../services/api';\nimport { useAuth } from '../contexts/AuthContext';\n\n/**\r\n * Custom hook to fetch data from API endpoints with auth token support.\r\n *\r\n * @param {string} url - API endpoint\r\n * @param {any} initialData - Initial data value\r\n * @param {object} options - Additional axios request options\r\n */\nconst useApi = (url, initialData = null, options = {}) => {\n  _s();\n  const {\n    authToken\n  } = useAuth();\n  const [data, setData] = useState(initialData);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const cancelRequest = useRef(false);\n  const fetchData = useCallback(async () => {\n    if (!authToken) {\n      setError('No access token found. Please login.');\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    cancelRequest.current = false;\n    try {\n      const response = await api.get(url, {\n        ...options,\n        headers: {\n          Authorization: `Bearer ${authToken}`,\n          ...(options.headers || {})\n        }\n      });\n      if (!cancelRequest.current) {\n        setData(response.data);\n      }\n    } catch (err) {\n      if (!cancelRequest.current) {\n        var _err$response, _err$response$data, _err$response2, _err$response2$data;\n        // Handle different error structures\n        const message = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.error) || err.message || 'Failed to fetch data';\n        setError(message);\n      }\n    } finally {\n      if (!cancelRequest.current) {\n        setLoading(false);\n      }\n    }\n  }, [url, authToken, JSON.stringify(options)]);\n  useEffect(() => {\n    fetchData();\n    return () => {\n      cancelRequest.current = true; // Cancel ongoing requests on unmount\n    };\n  }, [fetchData]);\n  return {\n    data,\n    loading,\n    error,\n    refetch: fetchData\n  };\n};\n_s(useApi, \"a18Sv4lK+uk5q2/DfsXMhrtBy/A=\", false, function () {\n  return [useAuth];\n});\nexport default useApi;","map":{"version":3,"names":["useState","useEffect","useCallback","useRef","api","useAuth","useApi","url","initialData","options","_s","authToken","data","setData","loading","setLoading","error","setError","cancelRequest","fetchData","current","response","get","headers","Authorization","err","_err$response","_err$response$data","_err$response2","_err$response2$data","message","detail","JSON","stringify","refetch"],"sources":["C:/Users/varsa/Quiz-Website-Project/frontend_react/src/hooks/useApi.js"],"sourcesContent":["import { useState, useEffect, useCallback, useRef } from 'react';\r\nimport api from '../services/api';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\n/**\r\n * Custom hook to fetch data from API endpoints with auth token support.\r\n *\r\n * @param {string} url - API endpoint\r\n * @param {any} initialData - Initial data value\r\n * @param {object} options - Additional axios request options\r\n */\r\nconst useApi = (url, initialData = null, options = {}) => {\r\n  const { authToken } = useAuth();\r\n  const [data, setData] = useState(initialData);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const cancelRequest = useRef(false);\r\n\r\n  const fetchData = useCallback(async () => {\r\n    if (!authToken) {\r\n      setError('No access token found. Please login.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n    cancelRequest.current = false;\r\n\r\n    try {\r\n      const response = await api.get(url, {\r\n        ...options,\r\n        headers: {\r\n          Authorization: `Bearer ${authToken}`,\r\n          ...(options.headers || {}),\r\n        },\r\n      });\r\n\r\n      if (!cancelRequest.current) {\r\n        setData(response.data);\r\n      }\r\n    } catch (err) {\r\n      if (!cancelRequest.current) {\r\n        // Handle different error structures\r\n        const message =\r\n          err.response?.data?.detail ||\r\n          err.response?.data?.error ||\r\n          err.message ||\r\n          'Failed to fetch data';\r\n        setError(message);\r\n      }\r\n    } finally {\r\n      if (!cancelRequest.current) {\r\n        setLoading(false);\r\n      }\r\n    }\r\n  }, [url, authToken, JSON.stringify(options)]);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n\r\n    return () => {\r\n      cancelRequest.current = true; // Cancel ongoing requests on unmount\r\n    };\r\n  }, [fetchData]);\r\n\r\n  return { data, loading, error, refetch: fetchData };\r\n};\r\n\r\nexport default useApi;\r\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,WAAW,EAAEC,MAAM,QAAQ,OAAO;AAChE,OAAOC,GAAG,MAAM,iBAAiB;AACjC,SAASC,OAAO,QAAQ,yBAAyB;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,MAAM,GAAGA,CAACC,GAAG,EAAEC,WAAW,GAAG,IAAI,EAAEC,OAAO,GAAG,CAAC,CAAC,KAAK;EAAAC,EAAA;EACxD,MAAM;IAAEC;EAAU,CAAC,GAAGN,OAAO,CAAC,CAAC;EAC/B,MAAM,CAACO,IAAI,EAAEC,OAAO,CAAC,GAAGb,QAAQ,CAACQ,WAAW,CAAC;EAC7C,MAAM,CAACM,OAAO,EAAEC,UAAU,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACgB,KAAK,EAAEC,QAAQ,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAMkB,aAAa,GAAGf,MAAM,CAAC,KAAK,CAAC;EAEnC,MAAMgB,SAAS,GAAGjB,WAAW,CAAC,YAAY;IACxC,IAAI,CAACS,SAAS,EAAE;MACdM,QAAQ,CAAC,sCAAsC,CAAC;MAChD;IACF;IAEAF,UAAU,CAAC,IAAI,CAAC;IAChBE,QAAQ,CAAC,IAAI,CAAC;IACdC,aAAa,CAACE,OAAO,GAAG,KAAK;IAE7B,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMjB,GAAG,CAACkB,GAAG,CAACf,GAAG,EAAE;QAClC,GAAGE,OAAO;QACVc,OAAO,EAAE;UACPC,aAAa,EAAE,UAAUb,SAAS,EAAE;UACpC,IAAIF,OAAO,CAACc,OAAO,IAAI,CAAC,CAAC;QAC3B;MACF,CAAC,CAAC;MAEF,IAAI,CAACL,aAAa,CAACE,OAAO,EAAE;QAC1BP,OAAO,CAACQ,QAAQ,CAACT,IAAI,CAAC;MACxB;IACF,CAAC,CAAC,OAAOa,GAAG,EAAE;MACZ,IAAI,CAACP,aAAa,CAACE,OAAO,EAAE;QAAA,IAAAM,aAAA,EAAAC,kBAAA,EAAAC,cAAA,EAAAC,mBAAA;QAC1B;QACA,MAAMC,OAAO,GACX,EAAAJ,aAAA,GAAAD,GAAG,CAACJ,QAAQ,cAAAK,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcd,IAAI,cAAAe,kBAAA,uBAAlBA,kBAAA,CAAoBI,MAAM,OAAAH,cAAA,GAC1BH,GAAG,CAACJ,QAAQ,cAAAO,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAchB,IAAI,cAAAiB,mBAAA,uBAAlBA,mBAAA,CAAoBb,KAAK,KACzBS,GAAG,CAACK,OAAO,IACX,sBAAsB;QACxBb,QAAQ,CAACa,OAAO,CAAC;MACnB;IACF,CAAC,SAAS;MACR,IAAI,CAACZ,aAAa,CAACE,OAAO,EAAE;QAC1BL,UAAU,CAAC,KAAK,CAAC;MACnB;IACF;EACF,CAAC,EAAE,CAACR,GAAG,EAAEI,SAAS,EAAEqB,IAAI,CAACC,SAAS,CAACxB,OAAO,CAAC,CAAC,CAAC;EAE7CR,SAAS,CAAC,MAAM;IACdkB,SAAS,CAAC,CAAC;IAEX,OAAO,MAAM;MACXD,aAAa,CAACE,OAAO,GAAG,IAAI,CAAC,CAAC;IAChC,CAAC;EACH,CAAC,EAAE,CAACD,SAAS,CAAC,CAAC;EAEf,OAAO;IAAEP,IAAI;IAAEE,OAAO;IAAEE,KAAK;IAAEkB,OAAO,EAAEf;EAAU,CAAC;AACrD,CAAC;AAACT,EAAA,CAvDIJ,MAAM;EAAA,QACYD,OAAO;AAAA;AAwD/B,eAAeC,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}